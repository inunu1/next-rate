# 画面設計書

## 画面ID: ADM001  
## 画面名: 管理者管理画面

---

### 1. 画面概要

- 登録済みの管理者ユーザーを一覧表示し、新規登録および削除操作を行う。
- 自身のアカウントは削除不可とし、セッション情報に基づいて制御する。
- 非同期通信を使用せず、すべてHTMLフォームとSSRで構成。

---

### 2. 画面レイアウト

- 上部にメニューバー（画面タイトル、Dashboardボタン）
- 登録フォームバー（メールアドレス、名前、パスワード、登録ボタン）
- 管理者一覧テーブル（Email、Name、操作列）
- 操作列には削除ボタン（自身以外のユーザーのみ表示）

---

### 3. 入力項目

| 項目名         | 型       | 必須 | バリデーション     | 備考               |
|----------------|----------|------|--------------------|--------------------|
| メールアドレス | email    | ○    | メール形式         | 重複不可           |
| 名前           | text     | ×    | 最大50文字         | 任意入力           |
| パスワード     | password | ○    | 最小8文字以上推奨 | ハッシュ化して保存 |

---

### 4. 出力項目（表示内容）

| 項目名     | 型     | 備考                     |
|------------|--------|--------------------------|
| Email      | 文字列 | 登録済みメールアドレス   |
| Name       | 文字列 | 未設定の場合は「未設定」 |
| 操作       | ボタン | 削除（自身以外のみ表示） |

---

### 5. ボタン・操作

| ボタン名     | アクション       | 遷移先／処理内容               |
|--------------|------------------|--------------------------------|
| 管理者登録   | 登録処理         | `/admin/register` にPOST送信   |
| 削除         | 削除処理         | `/admin/delete` にPOST送信     |
| Dashboard    | ダッシュボードへ | `/dashboard` に遷移            |

---

### 6. 遷移仕様

| 遷移元画面     | 条件               | 遷移先画面     |
|----------------|--------------------|----------------|
| ログイン画面   | 認証成功           | 管理者管理画面 |
| 管理者管理画面 | 削除ボタン押下     | 同画面を再描画 |
| 管理者管理画面 | 登録フォーム送信   | 同画面を再描画 |
| 未ログイン時   | セッション未検出時 | `/login` にリダイレクト |

---

### 7. バリデーション仕様

- クライアント側チェック（HTML属性で対応）
  - `required` による必須入力
  - `type="email"` による形式チェック
- サーバー側チェック
  - メールアドレスの重複チェック
  - パスワードのハッシュ化
  - 自己削除の禁止（セッションIDと比較）

---

### 8. エラーメッセージ一覧

| エラーコード | メッセージ内容                     | 表示タイミング                     |
|--------------|------------------------------------|------------------------------------|
| E001         | メールアドレスを入力してください   | 登録フォーム送信時、未入力時       |
| E002         | パスワードを入力してください       | 登録フォーム送信時、未入力時       |
| E003         | メール形式が不正です               | 入力時、形式不一致時               |
| E004         | このメールアドレスは既に登録済みです | サーバー側で重複検出時             |
| E005         | 自分自身は削除できません           | 削除フォーム送信時、ID一致時       |

---

### 9. 備考

- この画面は管理者のみアクセス可能
- `useSession()` は使用せず、`getServerSession()` によるSSRセッション制御
- 非同期通信は一切使用せず、すべてHTMLフォームとPOSTルートで構成
- セッション情報は `session.user.id` を型拡張して安全に参照